c
c
c          example analysis of hollow sphere under internal pressure
c          to illustrate extensive use of skew boundary conditions.
c
c          Internal radius:  10 in.  External Radius:  60 in.
c          Region Modeled: 0<= theta <=30 degrees
c                          0<= phee  <=30 degrees
c                          3 elements over theta, 3 elements over
c                          phee, 5 elements over radius.
c
c          Nodal forces defined for 100 ksi internal pressure over
c          initial internal surface. 100 ksi applied in
c          step 1. An additional 400 ksi applied over 20 subsequent
c          steps.
c
c          Large geometry change effects included but the nodal
c          forces are not adjusted - the final pressure is thus
c          less than 500 ksi due to increase in internal radius
c
c          Material is simply Mises with constant hardening.
c
c          The ability to define "local" coordinate systems at
c          nodes for the specification of constraint is used
c          here to model what is actually an axisymmetric
c          problem.
c
c          Local coordinate systems are defined on the theta=30
c          and phee=30 faces. Displacements normal to these faces
c          are zero in the axisymmetric model.
c
c
c
c
structure sphere
c
c
material steel
    properties bilinear e 30000 nu 0.3 yld_pt 60 tan_e 500
c
c
number of nodes     96
number of elements    45
c
coordinates
     1   .999999905E+01   .000000000E+00   .000000000E+00
     2   .984807587E+01   .000000000E+00   .173648226E+01
     3   .984807682E+01   .173648167E+01   .000000000E+00
     4   .969846153E+01   .171010065E+01   .173648226E+01
     5   .939692497E+01   .000000000E+00   .342020225E+01
     6   .925416374E+01   .163175917E+01   .342020225E+01
     7   .939692497E+01   .342020130E+01   .000000000E+00
     8   .925416470E+01   .336824083E+01   .173648226E+01
     9   .883022022E+01   .321393800E+01   .342020225E+01
    10   .866025257E+01   .000000000E+00   .500000048E+01
    11   .852868366E+01   .150383735E+01   .500000048E+01
    12   .813797474E+01   .296198130E+01   .500000048E+01
    13   .866025257E+01   .500000000E+01   .000000000E+00
    14   .852868366E+01   .492403889E+01   .173648226E+01
    15   .813797569E+01   .469846296E+01   .342020225E+01
    16   .749999857E+01   .433012676E+01   .500000048E+01
    17   .199999981E+02   .000000000E+00   .000000000E+00
    18   .196961536E+02   .000000000E+00   .347296405E+01
    19   .196961536E+02   .347296357E+01   .000000000E+00
    20   .193969231E+02   .342020130E+01   .347296405E+01
    21   .187938499E+02   .000000000E+00   .684040403E+01
    22   .185083294E+02   .326351833E+01   .684040403E+01
    23   .187938499E+02   .684040260E+01   .000000000E+00
    24   .185083294E+02   .673648119E+01   .347296405E+01
    25   .176604404E+02   .642787600E+01   .684040356E+01
    26   .173205051E+02   .000000000E+00   .100000000E+02
    27   .170573673E+02   .300767469E+01   .100000000E+02
    28   .162759514E+02   .592396259E+01   .100000000E+02
    29   .173205051E+02   .100000000E+02   .000000000E+00
    30   .170573673E+02   .984807777E+01   .347296405E+01
    31   .162759514E+02   .939692593E+01   .684040356E+01
    32   .149999971E+02   .866025353E+01   .100000000E+02
    33   .299999981E+02   .000000000E+00   .000000000E+00
    34   .295442295E+02   .000000000E+00   .520944548E+01
    35   .295442295E+02   .520944500E+01   .000000000E+00
    36   .290953865E+02   .513030195E+01   .520944548E+01
    37   .281907749E+02   .000000000E+00   .102606049E+02
    38   .277624931E+02   .489527702E+01   .102606049E+02
    39   .281907749E+02   .102606039E+02   .000000000E+00
    40   .277624931E+02   .101047220E+02   .520944548E+01
    41   .264906616E+02   .964181328E+01   .102606049E+02
    42   .259807568E+02   .000000000E+00   .149999991E+02
    43   .255860519E+02   .451151180E+01   .149999991E+02
    44   .244139252E+02   .888594341E+01   .149999991E+02
    45   .259807587E+02   .150000000E+02   .000000000E+00
    46   .255860519E+02   .147721157E+02   .520944548E+01
    47   .244139252E+02   .140953884E+02   .102606049E+02
    48   .224999962E+02   .129903803E+02   .149999991E+02
    49   .346410103E+02   .200000000E+02   .000000000E+00
    50   .341147347E+02   .196961536E+02   .694592714E+01
    51   .325519028E+02   .187938519E+02   .136808052E+02
    52   .299999943E+02   .173205071E+02   .199999981E+02
    53   .433012619E+02   .250000000E+02   .000000000E+00
    54   .426434174E+02   .246201935E+02   .868240929E+01
    55   .406898766E+02   .234923153E+02   .171010056E+02
    56   .374999924E+02   .216506348E+02   .249999962E+02
    57   .519615173E+02   .300000000E+02   .000000000E+00
    58   .511721039E+02   .295442333E+02   .104188910E+02
    59   .488278542E+02   .281907787E+02   .205212078E+02
    60   .449999924E+02   .259807625E+02   .299999981E+02
    61   .399999962E+02   .000000000E+00   .000000000E+00
    62   .393923073E+02   .000000000E+00   .694592714E+01
    63   .393923073E+02   .694592762E+01   .000000000E+00
    64   .387938500E+02   .684040356E+01   .694592714E+01
    65   .375876999E+02   .000000000E+00   .136808052E+02
    66   .370166550E+02   .652703667E+01   .136808052E+02
    67   .375876999E+02   .136808062E+02   .000000000E+00
    68   .370166550E+02   .134729633E+02   .694592714E+01
    69   .353208809E+02   .128557520E+02   .136808052E+02
    70   .346410103E+02   .000000000E+00   .199999981E+02
    71   .341147347E+02   .601534939E+01   .199999981E+02
    72   .325519028E+02   .118479252E+02   .199999981E+02
    73   .469846230E+02   .171010075E+02   .000000000E+00
    74   .462708206E+02   .168412037E+02   .868240833E+01
    75   .441511040E+02   .160696907E+02   .171010056E+02
    76   .406898766E+02   .148099051E+02   .249999962E+02
    77   .563815498E+02   .205212097E+02   .000000000E+00
    78   .555249863E+02   .202094440E+02   .104188900E+02
    79   .529813271E+02   .192836285E+02   .205212078E+02
    80   .488278542E+02   .177718868E+02   .299999981E+02
    81   .433012619E+02   .000000000E+00   .249999962E+02
    82   .426434174E+02   .751918602E+01   .249999962E+02
    83   .511721039E+02   .902302361E+01   .299999981E+02
    84   .519615173E+02   .000000000E+00   .299999981E+02
    85   .499999962E+02   .000000000E+00   .000000000E+00
    86   .492403831E+02   .000000000E+00   .868240833E+01
    87   .492403831E+02   .868240929E+01   .000000000E+00
    88   .484923096E+02   .855050373E+01   .868240833E+01
    89   .469846230E+02   .000000000E+00   .171010037E+02
    90   .462708206E+02   .815879536E+01   .171010037E+02
    91   .590884590E+02   .104188910E+02   .000000000E+00
    92   .581907730E+02   .102606039E+02   .104188900E+02
    93   .555249863E+02   .979055500E+01   .205212059E+02
    94   .563815498E+02   .000000000E+00   .205212059E+02
    95   .599999924E+02   .000000000E+00   .000000000E+00
    96   .590884590E+02   .000000000E+00   .104188891E+02
c
elements
 1-45 type l3disop nonlinear material steel,
      order 2x2x2 bbar short center_output
c
incidences
     1     3     1    17    19     4     2    18    20
     2     6     5    21    22    11    10    26    27
     3    35    33    61    63    36    34    62    64
     4    38    37    65    66    43    42    70    71
     5    87    85    95    91    88    86    96    92
     6    90    89    94    93    82    81    84    83
     7    13     7    23    29    14     8    24    30
     8    15     9    25    31    16    12    28    32
     9    45    39    67    49    46    40    68    50
    10    47    41    69    51    48    44    72    52
    11    53    73    77    57    54    74    78    58
    12    55    75    79    59    56    76    80    60
    13     4     2    18    20     6     5    21    22
    14    36    34    62    64    38    37    65    66
    15    88    86    96    92    90    89    94    93
    16    14     8    24    30    15     9    25    31
    17    46    40    68    50    47    41    69    51
    18    54    74    78    58    55    75    79    59
    19    19    17    33    35    20    18    34    36
    20    22    21    37    38    27    26    42    43
    21    63    61    85    87    64    62    86    88
    22    66    65    89    90    71    70    81    82
    23    29    23    39    45    30    24    40    46
    24    31    25    41    47    32    28    44    48
    25    49    67    73    53    50    68    74    54
    26    51    69    75    55    52    72    76    56
    27    20    18    34    36    22    21    37    38
    28    64    62    86    88    66    65    89    90
    29    30    24    40    46    31    25    41    47
    30    50    68    74    54    51    69    75    55
    31     7     3    19    23     8     4    20    24
    32     9     6    22    25    12    11    27    28
    33    39    35    63    67    40    36    64    68
    34    41    38    66    69    44    43    71    72
    35    73    87    91    77    74    88    92    78
    36    75    90    93    79    76    82    83    80
    37     8     4    20    24     9     6    22    25
    38    40    36    64    68    41    38    66    69
    39    74    88    92    78    75    90    93    79
    40    23    19    35    39    24    20    36    40
    41    25    22    38    41    28    27    43    44
    42    67    63    87    73    68    64    88    74
    43    69    66    90    75    72    71    82    76
    44    24    20    36    40    25    22    38    41
    45    68    64    88    74    69    66    90    75
c
blocking automatic display
c
constraints  $ edge, faces just used to keep track during
c              model building.
c
c              edge 1 - theta=0, phee=30 nodes
c
 transformation matrix 10 26 42 70  81 84,
   row_1   0.86602540378444   0   0.50,
   row_2   0   1.0       0,
   row_3  -0.50   0   0.86602540378444
     10 26 42 70  81 84 v 0 w 0
c
c              edge 3 - theta=30, phee=30 nodes
c
 transformation matrix 16 32 48 52 56 60,
  row_1   0.750000   0.43301270035479   0.50,
  row_2  -0.50  0.86602540378444                  0,
  row_3  -0.43301270224701  -0.2500   0.86602540354791
     16 32 48 52 56 60 v 0 w 0
c
c              face 2 -- theta=30 face nodes
c
 transformation matrix 13 14 15 29 30 31 45 46 47 49 50 51,
                       53 54 55 57 58 59,
   row_1   0.86602540378444 0.5 0,
   row_2  -0.500  0.86602540378444  0,
   row_3   0 0 1
    13 14 15 29 30 31 45 46 47 49 50 51 53 54 55 57 58 59 v 0
c
c              edge 4  -- theta=10, phee=30 nodes
c
 transformation matrix  11 27 43 71 82 83,
  row_1     0.85286848096977   0.15038308480759   0.50000028197199,
  row_2    -0.17364817766693   0.98480775301221                  0,
  row_3    -0.49240415419440  -0.08682413779740   0.86602524098772
      11 27 43 71 82 83 w 0
c
c
c              edge 5 -- theta=20, phee=30 nodes
c
 transformation matrix 12 28 44 72 76 80,
  row_1   0.81379773990529   0.29619799268613   0.49999998765375,
  row_2   -0.34202014332567   0.93969262078591                  0,
  row_3   -0.46984629879128  -0.17101006744017   0.86602541091254
       12 28 44 72 76 80 w 0
c
c              phee = 0 nodes and theta=0 face
c
  plane z = 0 symmetry
  plane y = 0 symmetry
c
c           could use geometrically nonlinear face loading.
c
c loading unit_pressure $ 1 ksi internal pressure on initial cavity
c  element loads
c      1 13 2 31 37 32 7 16 8 face 3 pressure 1.0  $ << corrected list
c
 loading unit_press $ 100 ksi internal pressure on initial cavity
  nodal loads
 1 force_x 0.75002489E+02 force_y 0.65618597E+01 force_z 0.65618985E+01
 2 force_x 0.14550479E+03 force_y 0.12730024E+02 force_z 0.25521816E+02
 3 force_x 0.14772607E+03 force_y 0.26048092E+02 force_z 0.13123788E+02
 4 force_x 0.28658850E+03 force_y 0.50533269E+02 force_z 0.51043664E+02
 5 force_x 0.13254701E+03 force_y 0.11596406E+02 force_z 0.47965272E+02
 6 force_x 0.26106665E+03 force_y 0.46033136E+02 force_z 0.95930564E+02
 7 force_x 0.14095858E+03 force_y 0.51304750E+02 force_z 0.13123737E+02
 8 force_x 0.27345958E+03 force_y 0.99531147E+02 force_z 0.51043632E+02
 9 force_x 0.24910689E+03 force_y 0.90667445E+02 force_z 0.95930587E+02
 10 force_x 0.61078078E+02 force_y 0.53436547E+01 force_z 0.28481183E+02
 11 force_x 0.12030033E+03 force_y 0.21212219E+02 force_z 0.56962348E+02
 12 force_x 0.11478923E+03 force_y 0.41779848E+02 force_z 0.56962357E+02
 13 force_x 0.68235005E+02 force_y 0.31818517E+02 force_z 0.65618682E+01
 14 force_x 0.13237587E+03 force_y 0.61727902E+02 force_z 0.25521794E+02
 15 force_x 0.12058725E+03 force_y 0.56230715E+02 force_z 0.47965274E+02
 16 force_x 0.55566979E+02 force_y 0.25911283E+02 force_z 0.28481181E+02

c
 loading pressure
  nonlinear
    step 1 unit_press 1.0
    step 2-21 unit_press 0.2
c
 nonlinear analysis parameters
   solution technique direct sparse
   maximum iterations 20
   convergence test norm res tol 0.001
   line search on details
   adaptive on
   time step 100000
   trace solution on
   extrapolate on
c
c
 compute displacements for loading pressure step 21
 output precision displacements 1 8
 output precision displacements 84 83 80 60
 output precision displacements 10 11 12 16 $ w should be same...
c
c      mises stress and energy density for elements 1 and 8
c      shuould be the same
c
 output stresses 1 8
c
stop
c     alternate output commands
c
 output wide precision displacements
 output wide precision displacements 1 17 33 61 85 95
 output wide stresses 1 7 2 19 23 20 3 9 4 21 25 22 5 11 6
stop
  output flat stream displacements
  output flat stream element stresses





